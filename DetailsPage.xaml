<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="LocalAIRecorder.DetailsPage"
             Title="Recording Details">
    <Grid RowDefinitions="Auto,*,Auto" Padding="10">
        <VerticalStackLayout Grid.Row="0" Spacing="10">
            <Label Text="Transcript" FontSize="Subtitle" FontAttributes="Bold"/>
            <Editor x:Name="TranscriptEditor" 
                    Placeholder="Transcript will appear here..."
                    HeightRequest="150"
                    IsReadOnly="True"/>
            <Button x:Name="TranscribeButton" 
                    Text="Transcribe" 
                    Clicked="OnTranscribeClicked"/>
        </VerticalStackLayout>

        <CollectionView Grid.Row="1" x:Name="ChatCollectionView" Margin="0,10,0,0">
            <CollectionView.ItemTemplate>
                <DataTemplate>
                    <Frame Padding="10" Margin="5" BackgroundColor="{Binding IsUser, Converter={StaticResource BoolToColorConverter}}">
                        <Grid>
                            <Label Text="{Binding Text}" TextColor="Black"/>
                            <ActivityIndicator IsRunning="{Binding IsThinking}" 
                                             IsVisible="{Binding IsThinking}" 
                                             Color="Black"
                                             HeightRequest="20"
                                             WidthRequest="20"
                                             HorizontalOptions="Center"/>
                        </Grid>
                    </Frame>
                </DataTemplate>
            </CollectionView.ItemTemplate>
        </CollectionView>

        <Grid Grid.Row="2" ColumnDefinitions="*,Auto" ColumnSpacing="5">
            <Entry x:Name="ChatInput" Placeholder="Ask about the recording..."/>
            <Button Text="Send" Grid.Column="1" Clicked="OnSendClicked"/>
        </Grid>
        
        <ActivityIndicator x:Name="LoadingIndicator" IsRunning="False" IsVisible="False" Grid.RowSpan="3" HorizontalOptions="Center" VerticalOptions="Center"/>
    </Grid>
</ContentPage>